# 프론트엔드 Agent API 연동 테스트 가이드

## 목적
프론트엔드에서 Agent API가 올바르게 작동하는지 확인하고, 단순/복잡 질문이 올바르게 분기되는지 검증합니다.

## 사전 준비

### 1. 서버 실행
```bash
cd ~/fsf-llm-platform/server
source venv/bin/activate
uvicorn main:app --reload --port 8080
```

**확인:**
- http://localhost:8080/health
- http://localhost:8080/docs

### 2. 프론트엔드 실행
```bash
cd ~/fsf-llm-platform/frontend
npm run dev
```

**확인:**
- http://localhost:3000

## 테스트 케이스

### 테스트 1: 단순 질문 (chat.py 사용 예상)

**질문:**
- "손흥민 최근 폼은?"
- "토트넘은 어떤 팀인가요?"
- "프리미어리그 순위 알려줘"

**예상 결과:**
- ✅ 정상 응답
- ✅ `tools_used: ["rag_search"]` 또는 빈 배열
- ✅ 빠른 응답 시간 (캐시 히트 시)

**확인 방법:**
1. 브라우저 개발자 도구 열기 (F12)
2. Network 탭에서 `/api/llm/agent` 요청 확인
3. 응답에서 `tools_used` 필드 확인
4. 콘솔에서 로그 확인

### 테스트 2: 복잡 질문 (Agent 사용 예상)

**질문:**
- "손흥민 vs 홀란드 비교해줘"
- "맨유 vs 토트넘 비교"
- "오늘 경기 일정 알려줘"
- "내가 좋아하는 팀 경기 일정" (로그인 필요)

**예상 결과:**
- ✅ 정상 응답
- ✅ `tools_used: ["player_compare"]` 또는 `["calendar"]` 등
- ✅ Tool 정보가 UI에 뱃지 형태로 표시

**확인 방법:**
1. 브라우저 개발자 도구 열기 (F12)
2. Network 탭에서 `/api/llm/agent` 요청 확인
3. 응답에서 `tools_used` 필드 확인
4. UI에서 Tool 뱃지 표시 확인

### 테스트 3: 축약형 비교 질문

**질문:**
- "맨유 토트넘"
- "손흥민 홀란드"

**예상 결과:**
- ✅ 복잡 질문으로 분류
- ✅ `tools_used: ["player_compare"]` 또는 `["rag_search"]`

### 테스트 4: 사용자 ID 전달 (개인화)

**전제 조건:**
- 로그인 상태

**질문:**
- "내가 좋아하는 팀 경기 일정"
- "내가 픽한 선수들 하이라이트 추천해줘"

**예상 결과:**
- ✅ `user_id`가 요청에 포함됨
- ✅ `tools_used: ["fan_preference", "calendar"]` 등
- ✅ 개인화된 답변

**확인 방법:**
1. Network 탭에서 요청 본문 확인
2. `user_id` 필드가 포함되어 있는지 확인

## 확인 사항 체크리스트

- [ ] 서버가 정상 실행 중
- [ ] 프론트엔드가 정상 실행 중
- [ ] 단순 질문이 정상 응답
- [ ] 복잡 질문이 정상 응답
- [ ] `tools_used` 필드가 올바르게 반환됨
- [ ] Tool 정보가 UI에 표시됨 (뱃지 형태)
- [ ] 로그인 시 `user_id`가 전달됨
- [ ] 개인화된 답변이 제공됨

## 예상 문제 및 해결

### 문제 1: CORS 오류
**증상:** 브라우저 콘솔에 CORS 오류
**해결:** 서버의 CORS 설정 확인 (`server/main.py`)

### 문제 2: 404 오류
**증상:** `/api/llm/agent` 엔드포인트를 찾을 수 없음
**해결:** 서버 라우터 등록 확인 (`server/main.py`)

### 문제 3: `tools_used`가 빈 배열
**증상:** 단순 질문에서 `tools_used: []`
**해상:** 정상 동작 (단순 질문은 Tool 사용 안 함)

### 문제 4: Tool 뱃지가 표시되지 않음
**증상:** UI에 Tool 정보가 표시되지 않음
**해결:** `ChatBot.tsx`의 `toolsUsed` 필드 확인

## 테스트 결과 기록

### 테스트 날짜: YYYY-MM-DD
### 테스트 환경: 로컬 / 배포 (https://fsfproject-fd2e6.web.app)

#### 테스트 1: 단순 질문

| 질문 | 예상 분류 | 실제 분류 | tools_used | 응답 시간 | 결과 | 비고 |
|------|----------|----------|------------|----------|------|------|
| "손흥민 최근 폼은?" | 단순 | | | | | |
| "토트넘은 어떤 팀인가요?" | 단순 | | | | | |
| "프리미어리그 순위 알려줘" | 단순 | | | | | |

**정확도:** 0/3 (0%)

#### 테스트 2: 복잡 질문

| 질문 | 예상 분류 | 실제 분류 | tools_used | 응답 시간 | 결과 | 비고 |
|------|----------|----------|------------|----------|------|------|
| "손흥민 vs 홀란드 비교해줘" | 복잡 | | | | | |
| "맨유 vs 토트넘 비교" | 복잡 | | | | | |
| "오늘 경기 일정 알려줘" | 복잡 | | | | | |
| "내가 좋아하는 팀 경기 일정" | 복잡 | | | | | (로그인 필요) |

**정확도:** 0/4 (0%)

#### 테스트 3: 축약형 비교 질문

| 질문 | 예상 분류 | 실제 분류 | tools_used | 응답 시간 | 결과 | 비고 |
|------|----------|----------|------------|----------|------|------|
| "맨유 토트넘" | 복잡 | | | | | |
| "손흥민 홀란드" | 복잡 | | | | | |

**정확도:** 0/2 (0%)

#### 테스트 4: 사용자 ID 전달 (개인화)

| 질문 | user_id 전달 | tools_used | 개인화 답변 | 결과 | 비고 |
|------|-------------|------------|------------|------|------|
| "내가 좋아하는 팀 경기 일정" | | | | | |
| "내가 픽한 선수들 하이라이트 추천해줘" | | | | | |

**정확도:** 0/2 (0%)

### 전체 테스트 결과 요약

- **전체 정확도:** 0/11 (0%)
- **단순 질문 정확도:** 0/3 (0%)
- **복잡 질문 정확도:** 0/4 (0%)
- **축약형 감지율:** 0/2 (0%)
- **개인화 기능 정확도:** 0/2 (0%)

### 발견된 문제

1. 
2. 
3. 

### 개선 사항

1. 
2. 
3. 

---

## 성공 기준

✅ 모든 테스트 케이스가 정상 작동
✅ 단순/복잡 질문이 올바르게 분기됨
✅ Tool 정보가 UI에 표시됨
✅ 로그인 시 개인화 기능 작동

